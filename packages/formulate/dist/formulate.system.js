var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__restKey=e=>"symbol"==typeof e?e:e+"",__objRest=(e,t)=>{var r={};for(var s in e)__hasOwnProp.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&__getOwnPropSymbols)for(var s of __getOwnPropSymbols(e))t.indexOf(s)<0&&__propIsEnum.call(e,s)&&(r[s]=e[s]);return r};System.register("Vue3Formulate",["vue"],(function(e,t){"use strict";var r,s,o,i,n,a,l,u,c,d,h,p,m,f,x,y,b,g,v,E,_,V,P,w,F,O,A,$,j,C;return{setters:[e=>{r=e.h,s=e.resolveComponent,o=e.openBlock,i=e.createElementBlock,n=e.mergeProps,a=e.withModifiers,l=e.createBlock,u=e.toHandlers,c=e.createCommentVNode,d=e.renderSlot,h=e.normalizeProps,p=e.guardReactiveProps,m=e.normalizeClass,f=e.createElementVNode,x=e.resolveDynamicComponent,y=e.withCtx,b=e.toDisplayString,g=e.normalizeStyle,v=e.Fragment,E=e.renderList,_=e.createVNode,V=e.withDirectives,P=e.vModelRadio,w=e.vModelCheckbox,F=e.vModelDynamic,O=e.createTextVNode,A=e.vShow,$=e.vModelSelect,j=e.vModelText,C=e.withKeys}],execute:function(){const t=(e,t)=>({classification:e,component:"FormulateInput"+(t||e[0].toUpperCase()+e.substr(1))}),k=__spreadProps(__spreadValues({},["text","email","number","color","date","hidden","month","password","search","tel","time","url","week","datetime-local"].reduce(((e,r)=>__spreadProps(__spreadValues({},e),{[r]:t("text")})),{})),{range:t("slider"),textarea:t("textarea","TextArea"),checkbox:t("box"),radio:t("box"),submit:t("button"),button:t("button"),select:t("select"),file:t("file"),image:t("file"),group:t("group")});function S(e,t){const r={};for(let s in e)r[s]=t(s,e[s]);return r}function I(e,t,r=!1){if(e===t)return!0;if(!e||!t)return!1;if("object"!=typeof e&&"object"!=typeof t)return e===t;const s=Object.keys(e),o=Object.keys(t),i=s.length;if(o.length!==i)return!1;for(let n=0;n<i;n++){const o=s[n];if(!r&&e[o]!==t[o]||r&&!I(e[o],t[o],r))return!1}return!0}function N(e){return"string"==typeof e?e.replace(/([_-][a-z0-9])/gi,(t=>0===e.indexOf(t)||/[_-]/.test(e[e.indexOf(t)-1])?t:t.toUpperCase().replace(/[_-]/,""))):e}function D(e){return"string"==typeof e?e[0].toUpperCase()+e.substr(1):e}function R(e){return e?"string"==typeof e?[e]:Array.isArray(e)?e:"object"==typeof e?Object.values(e):[]:[]}function L(e,t){return"string"==typeof e?L(e.split("|"),t):Array.isArray(e)?e.map((e=>function(e,t){if("function"==typeof e)return[e,[]];if(Array.isArray(e)&&e.length){e=e.map((e=>e));const[r,s]=B(e.shift());if("string"==typeof r&&Object.hasOwn(t,r))return[t[r],e,r,s];if("function"==typeof r)return[r,e,r,s]}if("string"==typeof e&&e){const r=e.split(":"),[s,o]=B(r.shift());if(Object.hasOwn(t,s))return[t[s],r.length?r.join(":").split(","):[],s,o];throw new Error(`Unknown validation rule ${e}`)}return!1}(e,t))).filter((e=>!!e)):[]}function B(e){return/^[\^]/.test(e.charAt(0))?[N(e.substr(1)),e.charAt(0)]:[N(e),null]}function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function M(e,t){return!U(e,"__id")||t?Object.defineProperty(e,"__id",Object.assign(Object.create(null),{value:t||H(9)})):e}function G(e){return"number"!=typeof e&&(void 0===e||""===e||null===e||!1===e||Array.isArray(e)&&!e.some((e=>!G(e)))||e&&!Array.isArray(e)&&"object"==typeof e&&G(Object.values(e)))}function T(e,t){return Object.keys(e).reduce(((r,s)=>{const o=N(s);return t.includes(o)&&(r[o]=e[s]),r}),{})}function q(){let e;return function(t,r,s){e&&clearTimeout(e),e=setTimeout((()=>t.call(this,...r)),s)}}function H(e=13){return Math.random().toString(36).substring(2,e+2)}const W=/^(?:\w+:)?\/\/(\S+)$/,K=/^localhost[:?\d]*(?:[^:?\d]\S*)?$/,z=/^[^\s.]+\.\S{2,}$/;class Y{constructor(e,t,r={}){this.input=e,this.fileList=e.files,this.files=[],this.options=__spreadValues(__spreadValues({},{mimes:{}}),r),this.results=!1,this.context=t,this.dataTransferCheck(),t&&t.uploadUrl&&(this.options.uploadUrl=t.uploadUrl),this.uploadPromise=null,Array.isArray(this.fileList)?this.rehydrateFileList(this.fileList):this.addFileList(this.fileList)}rehydrateFileList(e){const t=e.reduce(((e,t)=>{const r=t[this.options?this.options.fileUrlKey:"url"],s=!(!r||!r.includes("."))&&r.substr(r.lastIndexOf(".")+1),o=this.options.mimes[s]||!1;return e.push(Object.assign({},t,r?{name:t.name||r.substr(r.lastIndexOf("/")+1||0),type:t.type?t.type:o,previewData:r}:{})),e}),[]);this.addFileList(t),this.results=this.mapUUID(e)}addFileList(e){for(let t=0;t<e.length;t++){const r=e[t],s=H(),o=function(){this.removeFile(s)};this.files.push({progress:!1,error:!1,complete:!1,justFinished:!1,name:r.name||"file-upload",file:r,uuid:s,path:!1,removeFile:o.bind(this),previewData:r.previewData||!1})}}hasUploader(){return!!this.context.uploader}uploaderIsAxios(){return!(!this.hasUploader()||"function"!=typeof this.context.uploader.request||"function"!=typeof this.context.uploader.get||"function"!=typeof this.context.uploader.delete||"function"!=typeof this.context.uploader.post)}getUploader(...e){if(this.uploaderIsAxios()){const t=new FormData;if(t.append(this.context.name||"file",e[0]),!1===this.context.uploadUrl)throw new Error("No uploadURL specified: https://vueformulate.com/guide/inputs/file/#props");return this.context.uploader.post(this.context.uploadUrl,t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:t=>{e[1](Math.round(100*t.loaded/t.total))}}).then((e=>e.data)).catch((t=>e[2](t)))}return this.context.uploader(...e)}upload(){return this.uploadPromise=this.uploadPromise?this.uploadPromise.then((()=>this.__performUpload())):this.__performUpload(),this.uploadPromise}__performUpload(){return new Promise(((e,t)=>{if(!this.hasUploader())return t(new Error("No uploader has been defined"));Promise.all(this.files.map((e=>(e.error=!1,e.complete=!!e.path,e.path?Promise.resolve(e.path):this.getUploader(e.file,(t=>{e.progress=t,this.context.rootEmit("file-upload-progress",t),t>=100&&(e.complete||(e.justFinished=!0,setTimeout((()=>{e.justFinished=!1}),this.options.uploadJustCompleteDuration)),e.complete=!0,this.context.rootEmit("file-upload-complete",e))}),(r=>{e.progress=0,e.error=r,e.complete=!0,this.context.rootEmit("file-upload-error",r),t(r)}),this.options))))).then((t=>{this.results=this.mapUUID(t),e(t)})).catch((e=>{throw new Error(e)}))}))}removeFile(e){const t=this.files.length;if(this.files=this.files.filter((t=>t&&t.uuid!==e)),Array.isArray(this.results)&&(this.results=this.results.filter((t=>t&&t.__id!==e))),this.context.performValidation(),window&&this.fileList instanceof FileList&&this.supportsDataTransfers){const e=new DataTransfer;this.files.forEach((t=>e.items.add(t.file))),this.fileList=e.files,this.input.files=this.fileList}else this.fileList=this.fileList.filter((t=>t&&t.__id!==e));t>this.files.length&&this.context.rootEmit("file-removed",this.files)}mergeFileList(e){if(this.addFileList(e.files),this.supportsDataTransfers){const t=new DataTransfer;this.files.forEach((e=>{e.file instanceof File&&t.items.add(e.file)})),this.fileList=t.files,this.input.files=this.fileList,e.files=(new DataTransfer).files}this.context.performValidation(),this.loadPreviews(),"delayed"!==this.context.uploadBehavior&&this.upload()}loadPreviews(){this.files.map((e=>{if(!e.previewData&&window&&window.FileReader&&/^image\//.test(e.file.type)){const t=new FileReader;t.onload=t=>Object.assign(e,{previewData:t.target.result}),t.readAsDataURL(e.file)}}))}dataTransferCheck(){try{new DataTransfer,this.supportsDataTransfers=!0}catch(e){this.supportsDataTransfers=!1}}getFiles(){return this.files}mapUUID(e){return e.map(((e,t)=>(this.files[t].path=void 0!==e&&e,e&&M(e,this.files[t].uuid))))}toString(){const e=this.files.length?this.files.length+" files":"empty";return this.results?JSON.stringify(this.results,null,"  "):`FileUpload(${e})`}}const J={accepted:function({value:e}){return Promise.resolve(["yes","on","1",1,!0,"true"].includes(e))},after:function({value:e},t=!1){const r=Date.parse(t||new Date),s=Date.parse(e);return Promise.resolve(!Number.isNaN(s)&&s>r)},alpha:function({value:e},t="default"){const r={default:/^[a-zA-ZÀ-ÖØ-öø-ÿĄąĆćĘęŁłŃńŚśŹźŻż]+$/,latin:/^[a-z]+$/i},s=Object.prototype.hasOwnProperty.call(r,t)?t:"default";return Promise.resolve(r[s].test(e))},alphanumeric:function({value:e},t="default"){const r={default:/^[a-zA-Z0-9À-ÖØ-öø-ÿĄąĆćĘęŁłŃńŚśŹźŻż]+$/,latin:/^[a-z0-9]+$/i},s=Object.prototype.hasOwnProperty.call(r,t)?t:"default";return Promise.resolve(r[s].test(e))},before:function({value:e},t=!1){const r=Date.parse(t||new Date),s=Date.parse(e);return Promise.resolve(!Number.isNaN(s)&&s<r)},between:function({value:e},t=0,r=10,s){return Promise.resolve(null!==t&&null!==r&&!Number.isNaN(t)&&!Number.isNaN(r)&&(!Number.isNaN(e)&&"length"!==s||"value"===s?(e=Number(e),t=Number(t),r=Number(r),e>t&&e<r):("string"==typeof e||"length"===s)&&(e=Number.isNaN(e)?e:e.toString()).length>t&&e.length<r))},confirm:function({value:e,getGroupValues:t,name:r},s){return Promise.resolve((()=>{const o=t();var i=s;return i||(i=r.endsWith("_confirm")?r.substr(0,r.length-8):`${r}_confirm`),o[i]===e})())},date:function({value:e},t=!1){return Promise.resolve(t&&"string"==typeof t?function(e){let t=`^${r=e,r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}$`;var r;const s={MM:"(0[1-9]|1[012])",M:"([1-9]|1[012])",DD:"([012][0-9]|3[01])",D:"([012]?[0-9]|3[01])",YYYY:"\\d{4}",YY:"\\d{2}"};return new RegExp(Object.keys(s).reduce(((e,t)=>e.replace(t,s[t])),t))}(t).test(e):!Number.isNaN(Date.parse(e)))},email:function({value:e}){return Promise.resolve(/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(e))},endsWith:function({value:e},...t){return Promise.resolve("string"==typeof e&&t.length?void 0!==t.find((t=>e.endsWith(t))):"string"==typeof e&&0===t.length)},in:function({value:e},...t){return Promise.resolve(void 0!==t.find((t=>"object"==typeof t?I(t,e):t===e)))},matches:function({value:e},...t){return Promise.resolve(!!t.find((t=>("string"==typeof t&&"/"===t.substr(0,1)&&"/"===t.substr(-1)&&(t=new RegExp(t.substr(1,t.length-2))),t instanceof RegExp?t.test(e):t===e))))},mime:function({value:e},...t){return Promise.resolve((()=>{if(e instanceof Y){const r=e.getFiles();for(let e=0;e<r.length;e++){const s=r[e].file;if(!t.includes(s.type))return!1}}return!0})())},min:function({value:e},t=1,r){return Promise.resolve(Array.isArray(e)?(t=Number.isNaN(t)?t:Number(t),e.length>=t):!Number.isNaN(e)&&"length"!==r||"value"===r?(e=Number.isNaN(e)?e:Number(e))>=t:("string"==typeof e||"length"===r)&&(e=Number.isNaN(e)?e:e.toString()).length>=t)},max:function({value:e},t=10,r){return Promise.resolve(Array.isArray(e)?(t=Number.isNaN(t)?t:Number(t),e.length<=t):!Number.isNaN(e)&&"length"!==r||"value"===r?(e=Number.isNaN(e)?e:Number(e))<=t:("string"==typeof e||"length"===r)&&(e=Number.isNaN(e)?e:e.toString()).length<=t)},not:function({value:e},...t){return Promise.resolve(void 0===t.find((t=>"object"==typeof t?I(t,e):t===e)))},number:function({value:e}){return Promise.resolve(!Number.isNaN(e))},required:function({value:e},t="pre"){return Promise.resolve(Array.isArray(e)?!!e.length:e instanceof Y?e.getFiles().length>0:"string"==typeof e?"trim"===t?!!e.trim():!!e:"object"!=typeof e||!!e&&!!Object.keys(e).length)},startsWith:function({value:e},...t){return Promise.resolve("string"==typeof e&&t.length?void 0!==t.find((t=>e.startsWith(t))):"string"==typeof e&&0===t.length)},url:function({value:e}){return Promise.resolve(function(e){if("string"!=typeof e)return!1;const t=e.match(W);if(!t)return!1;const r=t[1];return!(!r||!K.test(r)&&!z.test(r))}(e))},bail:function(){return Promise.resolve(!0)},optional:function({value:e}){return Promise.resolve(!G(e))}},Z="image/",Q={csv:"text/csv",gif:Z+"gif",jpg:Z+"jpeg",jpeg:Z+"jpeg",png:Z+"png",pdf:"application/pdf",svg:Z+"svg+xml"},X=["outer","wrapper","label","element","input","help","errors","error","decorator","rangeValue","uploadArea","uploadAreaMask","files","file","fileName","fileAdd","fileAddInput","fileRemove","fileProgress","fileUploadError","fileImagePreview","fileImagePreviewImage","fileProgressInner","grouping","groupRepeatable","groupRepeatableRemove","groupAddMore","form","formErrors","formError"],ee={hasErrors:e=>e.hasErrors,hasValue:e=>e.hasValue,isValid:e=>e.isValid},te=(e,t)=>{const r=e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase())),s=`formulate${["form","file"].includes(r.substr(0,4))?"":"-input"}${["decorator","range-value"].includes(r)?"-element":""}${"outer"!==r?`-${r}`:""}`;return"input"===r?[]:[s].concat(re(s,e,t))},re=(e,t,r)=>{const s=[];switch(t){case"label":s.push(`${e}--${r.labelPosition}`);break;case"element":const t="group"===r.classification?"group":r.type;s.push(`${e}--${t}`),"group"===t&&s.push("formulate-input-group");break;case"help":s.push(`${e}--${r.helpPosition}`);break;case"form":r.name&&s.push(`${e}--${r.name}`)}return s},se=(()=>{const e=[""].concat(Object.keys(ee).map((e=>D(e))));return X.reduce(((t,r)=>t.concat(e.reduce(((e,t)=>(e.push(`${r}${t}Class`),e)),[]))),[])})();function oe(e,t,r){switch(typeof t){case"string":return t;case"function":return t(r,R(e));case"object":if(Array.isArray(t))return R(e).concat(t);default:return e}}function ie(e){return X.reduce(((t,r)=>Object.assign(t,{[r]:te(r,e)})),{})}function ne(e){return"[object Object]"===Object.prototype.toString.call(e)}function ae(e){var t,r;return!1!==ne(e)&&(void 0===(t=e.constructor)||!1!==ne(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf"))}function le(e){return"string"==typeof e?e[0].toUpperCase()+e.substr(1):e}var ue={accepted:function(e){return"Please accept the "+e.name+"."},after:function(e){var t=e.name,r=e.args;return Array.isArray(r)&&r.length?le(t)+" must be after "+r[0]+".":le(t)+" must be a later date."},alpha:function(e){return le(e.name)+" can only contain alphabetical characters."},alphanumeric:function(e){return le(e.name)+" can only contain letters and numbers."},before:function(e){var t=e.name,r=e.args;return Array.isArray(r)&&r.length?le(t)+" must be before "+r[0]+".":le(t)+" must be an earlier date."},between:function(e){var t=e.name,r=e.value,s=e.args,o=!(!Array.isArray(s)||!s[2])&&s[2];return!isNaN(r)&&"length"!==o||"value"===o?le(t)+" must be between "+s[0]+" and "+s[1]+".":le(t)+" must be between "+s[0]+" and "+s[1]+" characters long."},confirm:function(e){var t=e.name;return e.args,le(t)+" does not match."},date:function(e){var t=e.name,r=e.args;return Array.isArray(r)&&r.length?le(t)+" is not a valid date, please use the format "+r[0]:le(t)+" is not a valid date."},default:function(e){return e.name,"This field isn’t valid."},email:function(e){e.name;var t=e.value;return t?"“"+t+"” is not a valid email address.":"Please enter a valid email address."},endsWith:function(e){e.name;var t=e.value;return t?"“"+t+"” doesn’t end with a valid value.":"This field doesn’t end with a valid value."},in:function(e){var t=e.name,r=e.value;return"string"==typeof r&&r?"“"+le(r)+"” is not an allowed "+t+".":"This is not an allowed "+t+"."},matches:function(e){return le(e.name)+" is not an allowed value."},max:function(e){var t=e.name,r=e.value,s=e.args;if(Array.isArray(r))return"You may only select "+s[0]+" "+t+".";var o=!(!Array.isArray(s)||!s[1])&&s[1];return!isNaN(r)&&"length"!==o||"value"===o?le(t)+" must be less than or equal to "+s[0]+".":le(t)+" must be less than or equal to "+s[0]+" characters long."},mime:function(e){var t=e.name,r=e.args;return le(t)+" must be of the type: "+(r[0]||"No file formats allowed.")},min:function(e){var t=e.name,r=e.value,s=e.args;if(Array.isArray(r))return"You need at least "+s[0]+" "+t+".";var o=!(!Array.isArray(s)||!s[1])&&s[1];return!isNaN(r)&&"length"!==o||"value"===o?le(t)+" must be at least "+s[0]+".":le(t)+" must be at least "+s[0]+" characters long."},not:function(e){var t=e.name;return"“"+e.value+"” is not an allowed "+t+"."},number:function(e){return le(e.name)+" must be a number."},required:function(e){return le(e.name)+" is required."},startsWith:function(e){e.name;var t=e.value;return t?"“"+t+"” doesn’t start with a valid value.":"This field doesn’t start with a valid value."},url:function(e){return e.name,"Please include a valid url."}};function ce(e){var t;e.extend({locales:(t={},t.en=ue,t)})}function de(e,t,r,s){return new Promise(((r,o)=>{const i=(s.fauxUploaderDuration||1500)*(.5+Math.random()),n=performance.now(),a=()=>setTimeout((()=>{const s=performance.now()-n,o=Math.min(100,Math.round(s/i*100));if(t(o),o>=100)return r({url:"http://via.placeholder.com/350x150.png",name:e.name});a()}),20);a()}))}const he={inheritAttrs:!1,functional:!0,props:{name:{type:String,required:!0},forceWrap:{type:Boolean,default:!1},context:{type:Object,default:()=>({})}},render(){var e=this.$parent;const t=this.$props,{name:s,forceWrap:o,context:i}=t,n=__objRest(t,["name","forceWrap","context"]);for(;e&&"FormulateInput"!==e.$options.name;)e=e.$parent;if(!e)return null;if(e.$slots&&e.$slots[s])return e.$slots[s](__spreadValues(__spreadValues({},i),n));if(Array.isArray(this.$slots.default())&&(this.$slots.default().length>1||o&&this.$slots.default().length>0)){const e=this.$attrs,{name:t,context:s}=e,o=__objRest(e,["name","context"]);return r("div",__spreadValues(__spreadValues({},this.$attrs),o),this.$slots.default())}return Array.isArray(this.$slots.default())&&1===this.$slots.default().length?this.$slots.default()[0]:null}};function pe(e,t=0,r={}){if(e&&"object"==typeof e&&!Array.isArray(e)){let s=e,{children:o=null,component:i="FormulateInput",depth:n=1,key:a=null}=s,l=__objRest(s,["children","component","depth","key"]);const u=l.class||{};delete l.class;const c={},d=Object.keys(l).reduce(((e,t)=>t.startsWith("@")?Object.assign(e,{[t.substr(1)]:l[t]}):e),{});Object.keys(d).forEach((e=>{delete l[`@${e}`],c[e]=function(e,t,r){return function(...s){return"function"==typeof t?t.call(this,...s):"string"==typeof t&&U(r,t)?r[t].call(this,...s):U(r,e)?r[e].call(this,...s):void 0}}(e,d[e],r)}));const h="FormulateInput"===i?l.type||"text":i,p=l.name||h||"el";a||(a=l.id?l.id:"FormulateInput"!==i&&"string"==typeof o?`${h}-${function(e,t=0){let r=3735928559^t,s=1103547991^t;for(let o,i=0;i<e.length;i++)o=e.charCodeAt(i),r=Math.imul(r^o,2654435761),s=Math.imul(s^o,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&s)+(r>>>0)}(o)}`:`${h}-${p}-${n}${l.name?"":"-"+t}`);const m=Array.isArray(o)?o.map((e=>Object.assign(e,{depth:n+1}))):o;return Object.assign({key:a,depth:n,attrs:l,component:i,class:u,on:c},m?{children:m}:{})}return null}function me(e,t,r){return Array.isArray(t)?t.map(((t,s)=>{const o=pe(t,s,r);return e(o.component,{attrs:o.attrs,class:o.class,key:o.key,on:o.on},o.children?me(e,o.children,r):null)})):t}const fe={functional:!0,render:(e,{props:t,listeners:r})=>me(e,t.schema,r)};class xe{constructor(e){this.registry=new Map,this.errors={},this.ctx=e}add(e,t){return this.registry.set(e,t),this.errors=__spreadProps(__spreadValues({},this.errors),{[e]:t.getErrorObject().hasErrors}),this}remove(e){this.ctx.deps.delete(this.registry.get(e)),this.ctx.deps.forEach((t=>t.delete(e)));let t=this.ctx.keepModelData;!t&&this.registry.has(e)&&"inherit"!==this.registry.get(e).keepModelData&&(t=this.registry.get(e).keepModelData),this.ctx.preventCleanup&&(t=!0),this.registry.delete(e);const r=this.errors,{[e]:s}=r,o=__objRest(r,[__restKey(e)]);if(this.errors=o,!t){const t=this.ctx.proxy,{[e]:r}=t,s=__objRest(t,[__restKey(e)]);this.ctx.uuid&&M(s,this.ctx.uuid),this.ctx.proxy=s,this.ctx.$emit("input",this.ctx.proxy)}return this}has(e){return this.registry.has(e)}get(e){return this.registry.get(e)}map(e){const t={};return this.registry.forEach(((r,s)=>Object.assign(t,{[s]:e(r,s)}))),t}keys(){return Array.from(this.registry.keys())}register(e,t){if(U(t.$props,"ignored"))return!1;if(this.registry.has(e))return this.ctx.$nextTick((()=>!this.registry.has(e)&&this.register(e,t))),!1;this.add(e,t);const r=U(t.$props,"formulateValue"),s=U(t.$props,"value"),o=this.ctx.debounce||this.ctx.debounceDelay||this.ctx.context&&this.ctx.context.debounceDelay;o&&!U(t.$props,"debounce")&&(t.debounceDelay=o),r||!this.ctx.hasInitialValue||G(this.ctx.initialValues[e])?!r&&!s||I(t.proxy,this.ctx.initialValues[e],!0)||this.ctx.setFieldValue(e,t.proxy):t.context.model=this.ctx.initialValues[e],this.childrenShouldShowErrors&&(t.formShouldShowErrors=!0)}reduce(e,t){return this.registry.forEach(((r,s)=>{t=e(t,r,s)})),t}dataProps(){return{proxy:{},registry:this,register:this.register.bind(this),deregister:e=>this.remove(e),childrenShouldShowErrors:!1,errorObservers:[],deps:new Map,preventCleanup:!1}}}function ye(e){return new xe(e).dataProps()}function be(e={}){return{hasInitialValue(){return this.formulateValue&&"object"==typeof this.formulateValue||this.values&&"object"==typeof this.values||this.isGrouping&&"object"==typeof this.context.model[this.index]},isVmodeled(){const e=Object.prototype.hasOwnProperty.call(this.$props,"formulateValue"),t=this.$attrs&&("function"==typeof this.$attrs.onInput||"function"==typeof this.$attrs["onUpdate:modelValue"]);return!(!e||!t)},initialValues(){return U(this.$props,"formulateValue")&&"object"==typeof this.formulateValue?__spreadValues({},this.formulateValue):U(this.$props,"values")&&"object"==typeof this.values?__spreadValues({},this.values):this.isGrouping&&"object"==typeof this.context.model[this.index]?this.context.model[this.index]:{}},mergedGroupErrors(){const e=/^([^.\d+].*?)\.(\d+\..+)$/;return Object.keys(this.mergedFieldErrors).filter((t=>e.test(t))).reduce(((t,r)=>{let[,s,o]=r.match(e);return t[s]||(t[s]={}),Object.assign(t[s],{[o]:this.mergedFieldErrors[r]}),t}),{})}}}function ge(e=[]){const t={applyInitialValues(){this.hasInitialValue&&(this.proxy=__spreadValues({},this.initialValues))},setFieldValue(e,t){if(void 0===t){const t=this.proxy,{[e]:r}=t,s=__objRest(t,[__restKey(e)]);this.proxy=s}else Object.assign(this.proxy,{[e]:t});this.$emit("input",__spreadValues({},this.proxy))},valueDeps(e){return Object.keys(this.proxy).reduce(((t,r)=>Object.defineProperty(t,r,{enumerable:!0,get:()=>{const t=this.registry.get(r);return this.deps.set(e,this.deps.get(e)||new Set),t&&(this.deps.set(t,this.deps.get(t)||new Set),this.deps.get(t).add(e.name)),this.deps.get(e).add(r),this.proxy[r]}})),Object.create(null))},validateDeps(e){this.deps.has(e)&&this.deps.get(e).forEach((e=>this.registry.has(e)&&this.registry.get(e).performValidation()))},hasValidationErrors(){return Promise.all(this.registry.reduce(((e,t,r)=>(e.push(t.performValidation()&&t.getValidationErrors()),e)),[])).then((e=>e.some((e=>e.hasErrors))))},showErrors(){this.childrenShouldShowErrors=!0,this.registry.map((e=>{e.formShouldShowErrors=!0}))},hideErrors(){this.childrenShouldShowErrors=!1,this.registry.map((e=>{e.formShouldShowErrors=!1,e.behavioralErrorVisibility=!1}))},setValues(e){Array.from(new Set(Object.keys(e||{}).concat(Object.keys(this.proxy)))).forEach((t=>{const r=this.registry.has(t)&&this.registry.get(t);let s=e?e[t]:void 0;r&&!I(r.proxy,s,!0)&&(r.context.model=s),I(s,this.proxy[t],!0)||this.setFieldValue(t,s)}))},updateValidation(e){U(this.registry.errors,e.name)&&(this.registry.errors[e.name]=e.hasErrors),this.$emit("validation",e)},addErrorObserver(e){this.errorObservers.find((t=>e.callback===t.callback))||(this.errorObservers.push(e),"form"===e.type?e.callback(this.mergedFormErrors):"group"===e.type&&U(this.mergedGroupErrors,e.field)?e.callback(this.mergedGroupErrors[e.field]):U(this.mergedFieldErrors,e.field)&&e.callback(this.mergedFieldErrors[e.field]))},removeErrorObserver(e){this.errorObservers=this.errorObservers.filter((t=>t.callback!==e))}};return Object.keys(t).reduce(((r,s)=>e.includes(s)?r:__spreadProps(__spreadValues({},r),{[s]:t[s]})),{})}function ve(){return{mergedFieldErrors:{handler(e){this.errorObservers.filter((e=>"input"===e.type)).forEach((t=>t.callback(e[t.field]||[])))},immediate:!0},mergedGroupErrors:{handler(e){this.errorObservers.filter((e=>"group"===e.type)).forEach((t=>t.callback(e[t.field]||{})))},immediate:!0}}}function Ee(e,t=[]){const r={formulateSetter:e.setFieldValue,formulateRegister:e.register,formulateDeregister:e.deregister,formulateFieldValidation:e.updateValidation,getFormValues:e.valueDeps,getGroupValues:e.valueDeps,validateDependents:e.validateDeps,observeErrors:e.addErrorObserver,removeErrorObserver:e.removeErrorObserver};return Object.keys(r).filter((e=>!t.includes(e))).reduce(((e,t)=>Object.assign(e,{[t]:r[t]})),{})}function _e(e){switch(typeof e){case"symbol":case"number":case"string":case"boolean":case"undefined":return!0;default:return null===e}}function Ve(e){if("object"!=typeof e)return e;const t=Array.isArray(e)?[]:{};for(const r in e)e[r]instanceof Y||_e(e[r])?t[r]=e[r]:t[r]=Ve(e[r]);return t}class Pe{constructor(e){this.form=e}hasValidationErrors(){return this.form.hasValidationErrors()}values(){return new Promise(((e,t)=>{const r=[],s=Ve(this.form.proxy);for(const o in s)"object"==typeof this.form.proxy[o]&&this.form.proxy[o]instanceof Y&&r.push(this.form.proxy[o].upload().then((e=>Object.assign(s,{[o]:e}))));Promise.all(r).then((()=>e(s))).catch((e=>t(e)))}))}}const we=(e,t)=>{const r=e.__vccOpts||e;for(const[s,o]of t)r[s]=o;return r};const Fe=we({name:"FormulateForm",provide(){return __spreadProps(__spreadValues({},Ee(this,["getGroupValues"])),{observeContext:this.addContextObserver,removeContextObserver:this.removeContextObserver})},inheritAttrs:!1,model:{prop:"formulateValue",event:"input"},props:{name:{type:[String,Boolean],default:!1},formulateValue:{type:Object,default:()=>({})},values:{type:[Object,Boolean],default:!1},errors:{type:[Object,Boolean],default:!1},formErrors:{type:Array,default:()=>[]},schema:{type:[Array,Boolean],default:!1},keepModelData:{type:[Boolean,String],default:!1},invalidMessage:{type:[Boolean,Function,String],default:!1},debounce:{type:[Boolean,Number],default:!1}},emits:["created","failed-validation","validation"],data(){return __spreadProps(__spreadValues({},ye(this)),{formShouldShowErrors:!1,contextObservers:[],namedErrors:[],namedFieldErrors:{},isLoading:!1,hasFailedSubmit:!1})},computed:__spreadProps(__spreadValues({},be()),{schemaAttrs(){const e=this.$attrs,{submit:t}=e;return __objRest(e,["submit"])},pseudoProps(){return T(this.$attrs,se.filter((e=>/^form/.test(e))))},attributes(){const e=Object.keys(this.$attrs).filter((e=>!U(this.pseudoProps,N(e)))).reduce(((e,t)=>__spreadProps(__spreadValues({},e),{[t]:this.$attrs[t]})),{});return"string"==typeof this.name&&Object.assign(e,{name:this.name}),e},hasErrors(){return Object.values(this.registry.errors).some((e=>e))},isValid(){return!this.hasErrors},formContext(){return{errors:this.mergedFormErrors,pseudoProps:this.pseudoProps,hasErrors:this.hasErrors,value:this.proxy,hasValue:!G(this.proxy),isValid:this.isValid,isLoading:this.isLoading,classes:this.classes}},classes(){return this.$formulate.classes(__spreadProps(__spreadValues(__spreadValues({},this.$props),this.pseudoProps),{value:this.proxy,errors:this.mergedFormErrors,hasErrors:this.hasErrors,hasValue:!G(this.proxy),isValid:this.isValid,isLoading:this.isLoading,type:"form",classification:"form",attrs:this.$attrs}))},invalidErrors(){if(this.hasFailedSubmit&&this.hasErrors)switch(typeof this.invalidMessage){case"string":return[this.invalidMessage];case"object":return Array.isArray(this.invalidMessage)?this.invalidMessage:[];case"function":const e=this.invalidMessage(this.failingFields);return Array.isArray(e)?e:[e]}return[]},mergedFormErrors(){return this.formErrors.concat(this.namedErrors).concat(this.invalidErrors)},mergedFieldErrors(){const e={};if(this.errors)for(const t in this.errors)e[t]=R(this.errors[t]);for(const t in this.namedFieldErrors)e[t]=R(this.namedFieldErrors[t]);return e},hasFormErrorObservers(){return!!this.errorObservers.filter((e=>"form"===e.type)).length},failingFields(){return Object.keys(this.registry.errors).reduce(((e,t)=>__spreadValues(__spreadValues({},e),this.registry.errors[t]?{[t]:this.registry.get(t)}:{})),{})}}),watch:__spreadProps(__spreadValues({},ve()),{formulateValue:{handler(e){this.isVmodeled&&e&&"object"==typeof e&&this.setValues(e)},deep:!0},mergedFormErrors(e){this.errorObservers.filter((e=>"form"===e.type)).forEach((t=>t.callback(e)))}}),created(){this.$formulate.register(this),this.applyInitialValues(),this.$emit("created",this)},unmounted(){this.$formulate.deregister(this)},methods:__spreadProps(__spreadValues({},ge()),{applyErrors({formErrors:e,inputErrors:t}){this.namedErrors=e,this.namedFieldErrors=t},addContextObserver(e){this.contextObservers.find((t=>t===e))||(this.contextObservers.push(e),e(this.formContext))},removeContextObserver(e){this.contextObservers.filter((t=>t!==e))},registerErrorComponent(e){this.errorComponents.includes(e)||this.errorComponents.push(e)},formSubmitted(){if(this.isLoading)return;this.isLoading=!0,this.showErrors();const e=new Pe(this),t=this.$attrs["submit-raw"]||this.$attrs.submitRaw,r="function"==typeof t?t(e):Promise.resolve(e);return(r instanceof Promise?r:Promise.resolve(r)).then((t=>{const r=t instanceof Pe?t:e;return r.hasValidationErrors().then((e=>[r,e]))})).then((([e,t])=>t||"function"!=typeof this.$attrs.submit?this.onFailedValidation():e.values().then((e=>{this.hasFailedSubmit=!1;const t=this.$attrs.submit(e);return(t instanceof Promise?t:Promise.resolve()).then((()=>e))})))).finally((()=>{this.isLoading=!1}))},onFailedValidation(){return this.hasFailedSubmit=!0,this.$emit("failed-validation",__spreadValues({},this.failingFields)),this.$formulate.failedValidation(this)}})},[["render",function(e,t,r,m,f,x){const y=s("FormulateSchema"),b=s("FormulateErrors");return o(),i("form",n({class:x.classes.form},x.attributes,{onSubmit:t[0]||(t[0]=a(((...e)=>x.formSubmitted&&x.formSubmitted(...e)),["prevent"]))}),[r.schema?(o(),l(y,n({key:0,schema:r.schema},u(e.schemaListeners)),null,16,["schema"])):c("",!0),x.hasFormErrorObservers?c("",!0):(o(),l(b,{key:1,context:x.formContext},null,8,["context"])),d(e.$slots,"default",h(p(x.formContext)))],16)}]]),Oe={context(){return Ce.call(this,__spreadValues({addLabel:this.logicalAddLabel,removeLabel:this.logicalRemoveLabel,attributes:this.elementAttributes,blurHandler:je.bind(this),classification:this.classification,component:this.component,debounceDelay:this.debounceDelay,disableErrors:this.disableErrors,errors:this.explicitErrors,formShouldShowErrors:this.formShouldShowErrors,getValidationErrors:this.getValidationErrors.bind(this),groupErrors:this.mergedGroupErrors,hasGivenName:this.hasGivenName,hasValue:this.hasValue,hasLabel:this.label&&"button"!==this.classification,hasValidationErrors:this.hasValidationErrors.bind(this),help:this.help,helpPosition:this.logicalHelpPosition,id:this.id||this.defaultId,ignored:U(this,"ignored"),isValid:this.isValid,imageBehavior:this.imageBehavior,label:this.label,labelPosition:this.logicalLabelPosition,limit:this.limit===1/0?this.limit:Number.parseInt(this.limit,10),name:this.nameOrFallback,minimum:Number.parseInt(this.minimum,10),performValidation:this.performValidation.bind(this),pseudoProps:this.pseudoProps,preventWindowDrops:this.preventWindowDrops,removePosition:this.mergedRemovePosition,repeatable:this.repeatable,rootEmit:this.$emit.bind(this),rules:this.ruleDetails,setErrors:this.setErrors.bind(this),showValidationErrors:this.showValidationErrors,slotComponents:this.slotComponents,slotProps:this.slotProps,type:this.type,uploadBehavior:this.uploadBehavior,uploadUrl:this.mergedUploadUrl,uploader:this.uploader||this.$formulate.getUploader(),validationErrors:this.validationErrors,value:this.value,visibleValidationErrors:this.visibleValidationErrors,isSubField:this.isSubField,classes:this.classes},this.typeContext))},nameOrFallback:function(){if(!0===this.name&&"button"!==this.classification){const e=this.id||this.elementAttributes.id.replace(/[^0-9]/g,"");return`${this.type}_${e}`}if(!1===this.name||"button"===this.classification&&!0===this.name)return!1;return this.name},hasGivenName:function(){return"boolean"!=typeof this.name},typeContext:function(){switch(this.classification){case"select":return{options:Ae.call(this,this.options),optionGroups:!!this.optionGroups&&S(this.optionGroups,((e,t)=>Ae.call(this,t))),placeholder:this.$attrs.placeholder||!1};case"slider":return{showValue:!!this.showValue};default:return this.options?{options:Ae.call(this,this.options)}:{}}},elementAttributes:function(){const e=Object.assign({},this.filteredAttributes);this.id?e.id=this.id:e.id=this.defaultId;this.hasGivenName&&(e.name=this.name);this.help&&!U(e,"aria-describedby")&&(e["aria-describedby"]=`${e.id}-help`);!this.classes.input||Array.isArray(this.classes.input)&&!this.classes.input.length||(e.class=this.classes.input);return e},logicalLabelPosition:function(){if(this.labelPosition)return this.labelPosition;if("box"===this.classification)return"after";return"before"},logicalHelpPosition:function(){if(this.helpPosition)return this.helpPosition;if("group"===this.classification)return"before";return"after"},mergedRemovePosition:function(){return"group"===this.type&&(this.removePosition||"before")},mergedUploadUrl:function(){return this.uploadUrl||this.$formulate.getUploadUrl()},mergedGroupErrors:function(){const e=Object.keys(this.groupErrors).concat(Object.keys(this.localGroupErrors)),t=/^(\d+)\.(.*)$/;return Array.from(new Set(e)).filter((e=>t.test(e))).reduce(((e,r)=>{let[,s,o]=r.match(t);U(e,s)||(e[s]={});const i=Array.from(new Set(R(this.groupErrors[r]).concat(R(this.localGroupErrors[r]))));return e[s]=Object.assign(e[s],{[o]:i}),e}),{})},hasValue:function(){const e=this.proxy;if("box"===this.classification&&this.isGrouped||"select"===this.classification&&U(this.filteredAttributes,"multiple"))return Array.isArray(e)?e.includes(this.value):this.value===e;return!G(e)},visibleValidationErrors:function(){return this.showValidationErrors&&this.validationErrors.length?this.validationErrors:[]},slotComponents:function(){const e=this.$formulate.slotComponent.bind(this.$formulate);return{addMore:e(this.type,"addMore"),buttonContent:e(this.type,"buttonContent"),errors:e(this.type,"errors"),file:e(this.type,"file"),help:e(this.type,"help"),label:e(this.type,"label"),prefix:e(this.type,"prefix"),remove:e(this.type,"remove"),repeatable:e(this.type,"repeatable"),suffix:e(this.type,"suffix"),uploadAreaMask:e(this.type,"uploadAreaMask")}},logicalAddLabel:function(){if("file"===this.classification)return!0===this.addLabel?`+ Add ${D(this.type)}`:this.addLabel;if("boolean"==typeof this.addLabel){const e=this.label||this.name;return`+ ${"string"==typeof e?e+" ":""} Add`}return this.addLabel},logicalRemoveLabel:function(){if("boolean"==typeof this.removeLabel)return"Remove";return this.removeLabel},classes:function(){return this.$formulate.classes(__spreadValues(__spreadValues(__spreadValues({},this.$props),this.pseudoProps),{attrs:this.filteredAttributes,classification:this.classification,hasErrors:this.hasVisibleErrors,hasValue:this.hasValue,helpPosition:this.logicalHelpPosition,isValid:this.isValid,labelPosition:this.logicalLabelPosition,type:this.type,value:this.proxy}))},showValidationErrors:function(){if(this.showErrors||this.formShouldShowErrors)return!0;if("file"===this.classification&&"live"===this.uploadBehavior&&ke.call(this))return!0;return this.behavioralErrorVisibility},slotProps:function(){const e=this.$formulate.slotProps.bind(this.$formulate);return{label:e(this.type,"label",this.typeProps),help:e(this.type,"help",this.typeProps),errors:e(this.type,"errors",this.typeProps),repeatable:e(this.type,"repeatable",this.typeProps),addMore:e(this.type,"addMore",this.typeProps),remove:e(this.type,"remove",this.typeProps),component:e(this.type,"component",this.typeProps)}},pseudoProps:function(){return T(this.localAttributes,se)},isValid:function(){return!this.hasErrors},ruleDetails:function(){return this.parsedValidation.map((([,e,t])=>({ruleName:t,args:e})))},isVmodeled:function(){const e=Object.prototype.hasOwnProperty.call(this,"formulateValue")||Object.prototype.hasOwnProperty.call(this.$props,"formulateValue"),t=this.$attrs&&("function"==typeof this.$attrs.onInput||"function"==typeof this.$attrs["onUpdate:modelValue"]);return!(!e||!t)},mergedValidationName:function(){try{const e=this.$formulate.options.validationNameStrategy||["validationName","name","label","type"];if(Array.isArray(e)){return this[e.find((e=>"string"==typeof this[e]))]}return"function"==typeof e?e.call(this,this):this.type}catch(e){}},explicitErrors:function(){return R(this.errors).concat(this.localErrors).concat(R(this.error))},allErrors:function(){return this.explicitErrors.concat(R(this.validationErrors))},hasVisibleErrors:function(){return Array.isArray(this.validationErrors)&&this.validationErrors.length&&this.showValidationErrors||!!this.explicitErrors.length},hasErrors:function(){return!!this.allErrors.length},filteredAttributes:function(){const e=Object.keys(this.pseudoProps).concat(Object.keys(this.typeProps));return Object.keys(this.localAttributes).reduce(((t,r)=>(e.includes(N(r))||(t[r]=this.localAttributes[r]),t)),{})},typeProps:function(){return T(this.localAttributes,this.$formulate.typeProps(this.type))},attrs:function(){const e=this.$attrs,{input:t}=e;return __objRest(e,["input"])}};function Ae(e){if(!e)return[];return(Array.isArray(e)?e:Object.keys(e).map((t=>({label:e[t],value:t})))).map($e.bind(this))}function $e(e){return"number"==typeof e&&(e=String(e)),"string"==typeof e?{label:e,value:e,id:`${this.elementAttributes.id}_${e}`}:("number"==typeof e.value&&(e.value=String(e.value)),Object.assign({value:"",label:"",id:`${this.elementAttributes.id}_${e.value||e.label}`},e))}function je(){"blur"!==this.errorBehavior&&"value"!==this.errorBehavior||(this.behavioralErrorVisibility=!0),this.$nextTick((()=>this.$emit("blur-context",this.context)))}function Ce(e){return Object.defineProperty(e,"model",{get:ke.bind(this),set:e=>{if(!this.mntd||!this.debounceDelay)return Se.call(this,e);this.dSet(Se,[e],this.debounceDelay)},enumerable:!0})}function ke(){const e=this.isVmodeled?"formulateValue":"proxy";return"checkbox"===this.type&&!Array.isArray(this[e])&&this.options?[]:this[e]||0===this[e]?this[e]:""}function Se(e){let t=!1;I(e,this.proxy,"group"===this.type)||(this.proxy=e,t=!0),!this.context.ignored&&this.context.name&&"function"==typeof this.formulateSetter&&this.formulateSetter(this.context.name,e),t&&this.$emit("input",e)}const Ie={name:"FormulateInput",provide(){return{formulateRegisterRule:this.registerRule,formulateRemoveRule:this.removeRule}},inject:{formulateSetter:{default:void 0},formulateFieldValidation:{default:()=>()=>({})},formulateRegister:{default:void 0},formulateDeregister:{default:void 0},getFormValues:{default:()=>()=>({})},getGroupValues:{default:void 0},validateDependents:{default:()=>()=>{}},observeErrors:{default:void 0},removeErrorObserver:{default:void 0},isSubField:{default:()=>()=>!1}},inheritAttrs:!1,model:{prop:"formulateValue",event:"input"},props:{type:{type:String,default:"text"},name:{type:[String,Boolean],default:!0},formulateValue:{default:""},value:{default:!1},options:{type:[Object,Array,Boolean],default:!1},optionGroups:{type:[Object,Boolean],default:!1},id:{type:[String,Boolean,Number],default:!1},label:{type:[String,Boolean],default:!1},labelPosition:{type:[String,Boolean],default:!1},limit:{type:[String,Number],default:1/0,validator:e=>1/0},minimum:{type:[String,Number],default:0,validator:e=>Number.parseInt(e,10)==e},help:{type:[String,Boolean],default:!1},helpPosition:{type:[String,Boolean],default:!1},isGrouped:{type:Boolean,default:!1},errors:{type:[String,Array,Boolean],default:!1},removePosition:{type:[String,Boolean],default:!1},repeatable:{type:Boolean,default:!1},validation:{type:[String,Boolean,Array],default:!1},validationName:{type:[String,Boolean],default:!1},error:{type:[String,Boolean],default:!1},errorBehavior:{type:String,default:"blur",validator:function(e){return["blur","live","submit","value"].includes(e)}},showErrors:{type:Boolean,default:!1},groupErrors:{type:Object,default:()=>({}),validator:e=>{const t=/^\d+\./;return!Object.keys(e).some((e=>!t.test(e)))}},imageBehavior:{type:String,default:"preview"},uploadUrl:{type:[String,Boolean],default:!1},uploader:{type:[Function,Object,Boolean],default:!1},uploadBehavior:{type:String,default:"live"},preventWindowDrops:{type:Boolean,default:!0},showValue:{type:[String,Boolean],default:!1},validationMessages:{type:Object,default:()=>({})},validationRules:{type:Object,default:()=>({})},checked:{type:[String,Boolean],default:!1},disableErrors:{type:Boolean,default:!1},addLabel:{type:[Boolean,String],default:!0},removeLabel:{type:[Boolean,String],default:!1},keepModelData:{type:[Boolean,String],default:"inherit"},ignored:{type:[Boolean,String],default:!1},debounce:{type:[Boolean,Number],default:!1},preventDeregister:{type:Boolean,default:!1}},emits:["error-visibility","validation","input"],data(){try{return{defaultId:this.$formulate.nextId(this),localAttributes:{},localErrors:[],localGroupErrors:{},proxy:this.getInitialValue(),behavioralErrorVisibility:"live"===this.errorBehavior,formShouldShowErrors:!1,validationErrors:[],pendingValidation:Promise.resolve(),ruleRegistry:[],messageRegistry:{},touched:!1,debounceDelay:this.debounce,dSet:q(),mntd:!1}}catch(e){}},computed:__spreadProps(__spreadValues({},Oe),{classification(){const e=this.$formulate.classify(this.type);return"box"===e&&this.options?"group":e},component(){return"group"===this.classification?"FormulateInputGroup":this.$formulate.component(this.type)},parsedValidationRules(){const e={};return Object.keys(this.validationRules).forEach((t=>{e[N(t)]=this.validationRules[t]})),e},parsedValidation(){return L(this.validation,this.$formulate.rules(this.parsedValidationRules))},messages(){const e={};return Object.keys(this.validationMessages).forEach((t=>{e[N(t)]=this.validationMessages[t]})),Object.keys(this.messageRegistry).forEach((t=>{e[N(t)]=this.messageRegistry[t]})),e},listeners(){const e=Object.entries(this.$attrs).filter((([e])=>e.startsWith("on")));return Object.fromEntries(e)}}),watch:{$attrs:{handler(e){this.updateLocalAttributes(e)},deep:!0},proxy:{handler:function(e,t){this.performValidation(),this.isVmodeled||I(e,t,"group"===this.type)||(this.context.model=e),this.validateDependents(this),!this.touched&&e&&(this.touched=!0)},deep:!0},formulateValue:{handler:function(e,t){this.isVmodeled&&!I(e,t,"group"===this.type)&&(this.context.model=e)},deep:!0},showValidationErrors:{handler(e){this.$emit("error-visibility",e)},immediate:!0},validation:{handler(){this.performValidation()},deep:!0},touched(e){"value"===this.errorBehavior&&e&&(this.behavioralErrorVisibility=e)},debounce(e){this.debounceDelay=e}},created(){this.applyInitialValue(),this.formulateRegister&&"function"==typeof this.formulateRegister&&this.formulateRegister(this.nameOrFallback,this),this.applyDefaultValue(),this.disableErrors||"function"!=typeof this.observeErrors||(this.observeErrors({callback:this.setErrors,type:"input",field:this.nameOrFallback}),"group"===this.type&&this.observeErrors({callback:this.setGroupErrors,type:"group",field:this.nameOrFallback})),this.updateLocalAttributes(this.$attrs),this.performValidation(),this.hasValue&&(this.touched=!0)},mounted(){this.mntd=!0},beforeUnmount(){this.disableErrors||"function"!=typeof this.removeErrorObserver||(this.removeErrorObserver(this.setErrors),"group"===this.type&&this.removeErrorObserver(this.setGroupErrors)),"function"!=typeof this.formulateDeregister||this.preventDeregister||this.formulateDeregister(this.nameOrFallback)},methods:{getInitialValue(){let e=this.$formulate.classify(this.type);return e="box"===e&&this.options?"group":e,"box"===e&&this.checked?this.value||!0:U(this,"value")&&"box"!==e?this.value:U(this,"formulateValue")?this.formulateValue:"group"===e?Object.defineProperty("group"===this.type?[{}]:[],"__init",{value:!0}):""},applyInitialValue(){I(this.context.model,this.proxy)||"box"===this.classification&&!U(this,"options")||(this.context.model=this.proxy,this.$emit("input",this.proxy))},applyDefaultValue(){"select"===this.type&&!this.context.placeholder&&G(this.proxy)&&!this.isVmodeled&&!1===this.value&&this.context.options.length&&(U(this.$attrs,"multiple")?this.context.model=[]:this.context.model=this.context.options[0].value)},updateLocalAttributes(e){I(e,this.localAttributes)||(this.localAttributes=e)},performValidation(){let e=L(this.validation,this.$formulate.rules(this.parsedValidationRules));return e=this.ruleRegistry.length?this.ruleRegistry.concat(e):e,this.pendingValidation=this.runRules(e).then((e=>this.didValidate(e))),this.pendingValidation},runRules(e){const t=([e,t,r,s])=>{let o=e({value:this.context.model,getFormValues:(...e)=>this.getFormValues(this,...e),getGroupValues:(...e)=>this[`get${this.getGroupValues?"Group":"Form"}Values`](this,...e),name:this.context.name},...t);return o=o instanceof Promise?o:Promise.resolve(o),o.then((e=>!e&&this.getMessage(r,t)))};return new Promise((r=>{const s=(e,o=[])=>{const i=e.shift();Array.isArray(i)&&i.length?Promise.all(i.map(t)).then((e=>e.filter((e=>!!e)))).then((t=>(t=Array.isArray(t)?t:[]).length&&i.bail||!e.length?r(o.concat(t).filter((e=>!G(e)))):s(e,o.concat(t)))):r([])};s(function(e){const t=[],r=e.findIndex((([,,e])=>"bail"===e.toLowerCase())),s=e.findIndex((([,,e])=>"optional"===e.toLowerCase()));if(s>=0){const r=e.splice(s,1);t.push(Object.defineProperty(r,"bail",{value:!0}))}if(r>=0){const s=e.splice(0,r+1).slice(0,-1);s.length&&t.push(s),e.map((e=>t.push(Object.defineProperty([e],"bail",{value:!0}))))}else t.push(e);return t.reduce(((e,t)=>{const r=(e,t=!1)=>{if(e.length<2)return Object.defineProperty([e],"bail",{value:t});const s=[],o=e.findIndex((([,,,e])=>"^"===e));if(o>=0){const i=e.splice(0,o);i.length&&s.push(...r(i,t)),s.push(Object.defineProperty([e.shift()],"bail",{value:!0})),e.length&&s.push(...r(e,t))}else s.push(e);return s};return e.concat(r(t))}),[])}(e))}))},didValidate(e){const t=!I(e,this.validationErrors);if(this.validationErrors=e,t){const e=this.getErrorObject();this.$emit("validation",e),this.formulateFieldValidation&&"function"==typeof this.formulateFieldValidation&&this.formulateFieldValidation(e)}},getMessage(e,t){return this.getMessageFunc(e)({args:t,name:this.mergedValidationName,value:this.context.model,vm:this,formValues:this.getFormValues(this),getFormValues:(...e)=>this.getFormValues(this,...e),getGroupValues:(...e)=>this[`get${this.getGroupValues?"Group":"Form"}Values`](this,...e)})},getMessageFunc(e){if("optional"===(e=N(e)))return()=>[];if(this.messages&&void 0!==this.messages[e])switch(typeof this.messages[e]){case"function":return this.messages[e];case"string":case"boolean":return()=>this.messages[e]}return t=>this.$formulate.validationMessage(e,t,this)},hasValidationErrors(){return new Promise((e=>{this.$nextTick((()=>{this.pendingValidation.then((()=>e(!!this.validationErrors.length)))}))}))},getValidationErrors(){return new Promise((e=>{this.$nextTick((()=>this.pendingValidation.then((()=>e(this.getErrorObject())))))}))},getErrorObject(){return{name:this.context.nameOrFallback||this.context.name,errors:this.validationErrors.filter((e=>"string"==typeof e)),hasErrors:!!this.validationErrors.length}},setErrors(e){this.localErrors=R(e)},setGroupErrors(e){this.localGroupErrors=e},registerRule(e,t,r,s=null){this.ruleRegistry.some((e=>e[2]===r))||(this.ruleRegistry.push([e,t,r]),null!==s&&(this.messageRegistry[r]=s))},removeRule(e){const t=this.ruleRegistry.findIndex((t=>t[2]===e));t>=0&&(this.ruleRegistry.splice(t,1),delete this.messageRegistry[e])}}},Ne=["data-classification","data-has-errors","data-is-showing-errors","data-has-value","data-type"];const De=we(Ie,[["render",function(e,t,r,s,a,b){return o(),i("div",{class:m(e.context.classes.outer),"data-classification":b.classification,"data-has-errors":e.hasErrors,"data-is-showing-errors":e.hasVisibleErrors,"data-has-value":e.hasValue,"data-type":r.type},[f("div",{class:m(e.context.classes.wrapper)},["before"===e.context.labelPosition?d(e.$slots,"label",h(n({key:0},e.context)),(()=>[e.context.hasLabel?(o(),l(x(e.context.slotComponents.label),n({key:0},e.context.slotProps.label,{context:e.context}),null,16,["context"])):c("",!0)])):c("",!0),"before"===e.context.helpPosition?d(e.$slots,"help",h(n({key:1},e.context)),(()=>[e.context.help?(o(),l(x(e.context.slotComponents.help),n({key:0},e.context.slotProps.help,{context:e.context}),null,16,["context"])):c("",!0)])):c("",!0),d(e.$slots,"element",h(p(e.context)),(()=>[(o(),l(x(e.context.component),n({context:e.context},e.context.slotProps.component,u(b.listeners)),{default:y((()=>[d(e.$slots,"default",h(p(e.context)))])),_:3},16,["context"]))])),"after"===e.context.labelPosition?d(e.$slots,"label",h(n({key:2},e.context)),(()=>[e.context.hasLabel?(o(),l(x(e.context.slotComponents.label),n({key:0,context:e.context},e.context.slotProps.label),null,16,["context"])):c("",!0)])):c("",!0)],2),"after"===e.context.helpPosition?d(e.$slots,"help",h(n({key:0},e.context)),(()=>[e.context.help?(o(),l(x(e.context.slotComponents.help),n({key:0,context:e.context},e.context.slotProps.help),null,16,["context"])):c("",!0)])):c("",!0),d(e.$slots,"errors",h(p(e.context)),(()=>[e.context.disableErrors?c("",!0):(o(),l(x(e.context.slotComponents.errors),n({key:0,type:"FormulateErrors"===e.context.slotComponents.errors&&"input",context:e.context},e.context.slotProps.errors),null,16,["type","context"]))]))],10,Ne)}]]);const Re=we({inject:{observeErrors:{default:!1},removeErrorObserver:{default:!1},observeContext:{default:!1},removeContextObserver:{default:!1}},props:{context:{type:Object,default:()=>({})},type:{type:String,default:"form"}},data(){return{boundSetErrors:this.setErrors.bind(this),boundSetFormContext:this.setFormContext.bind(this),localErrors:[],formContext:{classes:{formErrors:"formulate-form-errors",formError:"formulate-form-error"}}}},computed:{visibleValidationErrors(){return Array.isArray(this.context.visibleValidationErrors)?this.context.visibleValidationErrors:[]},errors(){return Array.isArray(this.context.errors)?this.context.errors:[]},mergedErrors(){return this.errors.concat(this.localErrors)},visibleErrors(){return Array.from(new Set(this.mergedErrors.concat(this.visibleValidationErrors))).filter((e=>"string"==typeof e))},outerClass(){return"input"===this.type&&this.context.classes?this.context.classes.errors:this.formContext.classes.formErrors},itemClass(){return"input"===this.type&&this.context.classes?this.context.classes.error:this.formContext.classes.formError},role(){return"form"===this.type?"alert":"status"},ariaLive(){return"form"===this.type?"assertive":"polite"},slotComponent(){return this.$formulate.slotComponent(null,"errorList")}},created(){"form"===this.type&&"function"==typeof this.observeErrors&&(Array.isArray(this.context.errors)||this.observeErrors({callback:this.boundSetErrors,type:"form"}),this.observeContext(this.boundSetFormContext))},unmounted(){"form"===this.type&&"function"==typeof this.removeErrorObserver&&(Array.isArray(this.context.errors)||this.removeErrorObserver(this.boundSetErrors),this.removeContextObserver(this.boundSetFormContext))},methods:{setErrors(e){this.localErrors=R(e)},setFormContext(e){this.formContext=e}}},[["render",function(e,t,r,s,i,n){return o(),l(x(n.slotComponent),{"visible-errors":n.visibleErrors,"item-class":n.itemClass,"outer-class":n.outerClass,role:n.role,"aria-live":n.ariaLive,type:r.type},null,8,["visible-errors","item-class","outer-class","role","aria-live","type"])}]]),Le=["id","textContent"];const Be=we({props:{context:{type:Object,required:!0}}},[["render",function(e,t,r,s,n,a){return r.context.help?(o(),i("div",{key:0,id:`${r.context.id}-help`,class:m(r.context.classes.help),textContent:b(r.context.help)},null,10,Le)):c("",!0)}]]),Ue={props:{file:{type:Object,required:!0},imagePreview:{type:Boolean,default:!1},context:{type:Object,required:!0}}},Me=["src"],Ge=["title","textContent"],Te=["data-just-finished","data-is-finished"];const qe=we(Ue,[["render",function(e,t,r,s,n,a){return o(),i("div",{class:m(r.context.classes.file)},[r.imagePreview&&r.file.previewData?(o(),i("div",{key:0,class:m(r.context.classes.fileImagePreview)},[f("img",{src:r.file.previewData,class:m(r.context.classes.fileImagePreviewImage)},null,10,Me)],2)):c("",!0),f("div",{class:m(r.context.classes.fileName),title:r.file.name,textContent:b(r.file.name)},null,10,Ge),!1!==r.file.progress?(o(),i("div",{key:1,"data-just-finished":r.file.justFinished,"data-is-finished":!r.file.justFinished&&r.file.complete,class:m(r.context.classes.fileProgress)},[f("div",{class:m(r.context.classes.fileProgressInner),style:g({width:r.file.progress+"%"})},null,6)],10,Te)):c("",!0),r.file.complete&&!r.file.justFinished||!1===r.file.progress?(o(),i("div",{key:2,class:m(r.context.classes.fileRemove),onClick:t[0]||(t[0]=(...e)=>r.file.removeFile&&r.file.removeFile(...e))},null,2)):c("",!0)],2)}]]);const He=we({name:"FormulateGrouping",inject:["formulateRegisterRule","formulateRemoveRule"],provide(){return{isSubField:()=>!0,registerProvider:this.registerProvider,deregisterProvider:this.deregisterProvider}},props:{context:{type:Object,required:!0}},data:()=>({providers:[],keys:[]}),computed:{items(){return Array.isArray(this.context.model)?this.context.repeatable||0!==this.context.model.length?this.context.model.length<this.context.minimum?Array.from({length:this.context.minimum||1}).fill("").map(((e,t)=>this.setId(this.context.model[t]||{},t))):this.context.model.map(((e,t)=>this.setId(e,t))):[this.setId({},0)]:Array.from({length:this.context.minimum||1}).fill("").map(((e,t)=>this.setId({},t)))},formShouldShowErrors(){return this.context.formShouldShowErrors},groupErrors(){return this.items.map(((e,t)=>U(this.context.groupErrors,t)?this.context.groupErrors[t]:{}))}},watch:{providers(){this.formShouldShowErrors&&this.showErrors()},formShouldShowErrors(e){e&&this.showErrors()},items:{handler(e,t){I(e,t,!0)||(this.keys=e.map((e=>e.__id)))},immediate:!0}},created(){this.formulateRegisterRule(this.validateGroup.bind(this),[],"formulateGrouping",!0)},unmounted(){this.formulateRemoveRule("formulateGrouping")},methods:{validateGroup(){return Promise.all(this.providers.reduce(((e,t)=>(t&&"function"==typeof t.hasValidationErrors&&e.push(t.hasValidationErrors()),e)),[])).then((e=>!e.some((e=>!!e))))},showErrors(){this.providers.forEach((e=>e&&"function"==typeof e.showErrors&&e.showErrors()))},setItem(e,t){Array.isArray(this.context.model)&&this.context.model.length>=this.context.minimum&&!this.context.model.__init?this.context.model.splice(e,1,this.setId(t,e)):this.context.model=this.items.map(((r,s)=>s===e?this.setId(t,e):r))},removeItem(e){Array.isArray(this.context.model)&&this.context.model.length>this.context.minimum?(this.context.model=this.context.model.filter(((t,r)=>r!==e&&t)),this.context.rootEmit("repeatableRemoved",this.context.model)):!Array.isArray(this.context.model)&&this.items.length>this.context.minimum&&(this.context.model=Array.from({length:this.items.length-1}).fill("").map(((e,t)=>this.setId({},t))),this.context.rootEmit("repeatableRemoved",this.context.model))},registerProvider(e){this.providers.includes(e)||this.providers.push(e)},deregisterProvider(e){this.providers=this.providers.filter((t=>t!==e))},setId(e,t){return e.__id?e:M(e,this.keys[t])}}},[["render",function(e,t,r,n,a,u){const c=s("FormulateRepeatableProvider"),h=s("FormulateSlot");return o(),l(h,{name:"grouping",class:m(r.context.classes.grouping),context:r.context,"force-wrap":r.context.repeatable},{default:y((()=>[(o(!0),i(v,null,E(u.items,((t,s)=>(o(),l(c,{key:t.__id,index:s,context:r.context,uuid:t.__id,errors:u.groupErrors[s],onRemove:u.removeItem,onInput:e=>u.setItem(s,e)},{default:y((()=>[d(e.$slots,"default")])),_:2},1032,["index","context","uuid","errors","onRemove","onInput"])))),128))])),_:3},8,["class","context","force-wrap"])}]]),We=["id","for","textContent"];const Ke=we({props:{context:{type:Object,required:!0}}},[["render",function(e,t,r,s,n,a){return o(),i("label",{id:`${r.context.id}_label`,class:m(r.context.classes.label),for:r.context.id,textContent:b(r.context.label)},null,10,We)}]]);const ze=we({props:{context:{type:Object,required:!0},addMore:{type:Function,required:!0}}},[["render",function(e,t,r,n,a,l){const u=s("FormulateInput");return o(),i("div",{class:m(r.context.classes.groupAddMore)},[_(u,{type:"button",label:r.context.addLabel,"data-minor":"","data-ghost":"",onClick:r.addMore},null,8,["label","onClick"])],2)}]]),Ye={props:{context:{type:Object,required:!0}},computed:{type(){return this.context.type},attributes(){return this.context.attributes||{}},hasValue(){return this.context.hasValue}}},Je=["data-type"],Ze=["value"],Qe=["value"];const Xe=we({name:"FormulateInputBox",mixins:[Ye],computed:{usesDecorator(){return this.$formulate.options.useInputDecorators}}},[["render",function(e,t,r,a,d,h){const p=s("FormulateSlot");return o(),i("div",{class:m(e.context.classes.element),"data-type":e.context.type},[_(p,{name:"prefix",context:e.context},{default:y((()=>[e.context.slotComponents.prefix?(o(),l(x(e.context.slotComponents.prefix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"]),"radio"===e.type?V((o(),i("input",n({key:0,"onUpdate:modelValue":t[0]||(t[0]=t=>e.context.model=t),type:"radio",value:e.context.value},e.attributes,u(e.$attrs,!0),{onBlur:t[1]||(t[1]=(...t)=>e.context.blurHandler&&e.context.blurHandler(...t))}),null,16,Ze)),[[P,e.context.model]]):V((o(),i("input",n({key:1,"onUpdate:modelValue":t[2]||(t[2]=t=>e.context.model=t),type:"checkbox",value:e.context.value},e.attributes,u(e.$attrs,!0),{onBlur:t[3]||(t[3]=(...t)=>e.context.blurHandler&&e.context.blurHandler(...t))}),null,16,Qe)),[[w,e.context.model]]),h.usesDecorator?(o(),l(x("label"),{key:2,class:m(e.context.classes.decorator),for:e.attributes.id},null,8,["class","for"])):c("",!0),_(p,{name:"suffix",context:e.context},{default:y((()=>[e.context.slotComponents.suffix?(o(),l(x(e.context.slotComponents.suffix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"])],10,Je)}]]),et={props:{visibleErrors:{type:Array,required:!0},itemClass:{type:[String,Array,Object,Boolean],default:!1},outerClass:{type:[String,Array,Object,Boolean],default:!1},role:{type:[String],default:"status"},ariaLive:{type:[String,Boolean],default:"polite"},type:{type:String,required:!0}}},tt=["role","aria-live","textContent"];const rt=we(et,[["render",function(e,t,r,s,n,a){return r.visibleErrors.length?(o(),i("ul",{key:0,class:m(r.outerClass)},[(o(!0),i(v,null,E(r.visibleErrors,(e=>(o(),i("li",{key:e,class:m(r.itemClass),role:r.role,"aria-live":r.ariaLive,textContent:b(e)},null,10,tt)))),128))],2)):c("",!0)}]]),st=["data-type"],ot=["type"];const it=we({name:"FormulateInputText",mixins:[Ye]},[["render",function(e,t,r,a,d,h){const p=s("FormulateSlot");return o(),i("div",{class:m(e.context.classes.element),"data-type":e.context.type},[_(p,{name:"prefix",context:e.context},{default:y((()=>[e.context.slotComponents.prefix?(o(),l(x(e.context.slotComponents.prefix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"]),V(f("input",n({"onUpdate:modelValue":t[0]||(t[0]=t=>e.context.model=t),type:e.type},e.attributes,{onBlur:t[1]||(t[1]=(...t)=>e.context.blurHandler&&e.context.blurHandler(...t))},u(e.$attrs,!0)),null,16,ot),[[F,e.context.model]]),_(p,{name:"suffix",context:e.context},{default:y((()=>[e.context.slotComponents.suffix?(o(),l(x(e.context.slotComponents.suffix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"])],10,st)}]]),nt={name:"FormulateFiles",props:{files:{type:Y,required:!0},imagePreview:{type:Boolean,default:!1},context:{type:Object,required:!0}},computed:{fileUploads(){return this.files.files||[]},isMultiple(){return U(this.context.attributes,"multiple")}},watch:{files(){this.imagePreview&&this.files.loadPreviews()}},mounted(){this.imagePreview&&this.files.loadPreviews()},methods:{appendFiles(){const e=this.$refs.addFiles;e.files.length&&this.files.mergeFileList(e)}}},at=["data-has-error","data-has-preview"],lt=["textContent"];const ut=["data-type","data-has-files"],ct=["data-has-files"],dt=["data-is-drag-hover"];const ht=we({name:"FormulateInputFile",components:{FormulateFiles:we(nt,[["render",function(e,t,r,n,a,u){const d=s("FormulateSlot");return u.fileUploads.length?(o(),i("ul",{key:0,class:m(r.context.classes.files)},[(o(!0),i(v,null,E(u.fileUploads,(e=>(o(),i("li",{key:e.uuid,"data-has-error":!!e.error,"data-has-preview":!(!r.imagePreview||!e.previewData)},[_(d,{name:"file",context:r.context,file:e,"image-preview":r.imagePreview},{default:y((()=>[(o(),l(x(r.context.slotComponents.file),{context:r.context,file:e,"image-preview":r.imagePreview},null,8,["context","file","image-preview"]))])),_:2},1032,["context","file","image-preview"]),e.error?(o(),i("div",{key:0,class:m(r.context.classes.fileUploadError),textContent:b(e.error)},null,10,lt)):c("",!0)],8,at)))),128)),u.isMultiple&&r.context.addLabel?(o(),i("div",{key:0,class:m(r.context.classes.fileAdd),role:"button"},[O(b(r.context.addLabel)+" ",1),f("input",{ref:"addFiles",type:"file",multiple:"",class:m(r.context.classes.fileAddInput),onChange:t[0]||(t[0]=(...e)=>u.appendFiles&&u.appendFiles(...e))},null,34)],2)):c("",!0)],2)):c("",!0)}]])},mixins:[Ye],data:()=>({isOver:!1}),computed:{hasFiles(){return!!(this.context.model instanceof Y&&this.context.model.files.length)}},created(){Array.isArray(this.context.model)&&"string"==typeof this.context.model[0][this.$formulate.getFileUrlKey()]&&(this.context.model=this.$formulate.createUpload({files:this.context.model},this.context))},mounted(){window&&this.context.preventWindowDrops&&(window.addEventListener("dragover",this.preventDefault),window.addEventListener("drop",this.preventDefault))},unmounted(){window&&this.context.preventWindowDrops&&(window.removeEventListener("dragover",this.preventDefault),window.removeEventListener("drop",this.preventDefault))},methods:{preventDefault(e){"INPUT"!==e.target.tagName&&"file"!==e.target.getAttribute("type")&&(e=e||event).preventDefault()},handleFile(){this.isOver=!1;const e=this.$refs.file;e.files.length&&(this.context.model=this.$formulate.createUpload(e,this.context),this.$nextTick((()=>this.attemptImmediateUpload())))},attemptImmediateUpload(){"live"===this.context.uploadBehavior&&this.context.model instanceof Y&&this.context.hasValidationErrors().then((e=>{e||this.context.model.upload()}))},handleDragOver(e){e.preventDefault(),this.isOver=!0},handleDragLeave(e){e.preventDefault(),this.isOver=!1}}},[["render",function(e,t,r,a,d,h){const p=s("FormulateSlot"),b=s("FormulateFiles");return o(),i("div",{class:m(e.context.classes.element),"data-type":e.context.type,"data-has-files":h.hasFiles},[_(p,{name:"prefix",context:e.context},{default:y((()=>[e.context.slotComponents.prefix?(o(),l(x(e.context.slotComponents.prefix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"]),f("div",{class:m(e.context.classes.uploadArea),"data-has-files":h.hasFiles},[f("input",n({ref:"file","data-is-drag-hover":d.isOver,type:"file"},e.attributes,u(e.$attrs,!0),{onBlur:t[0]||(t[0]=(...t)=>e.context.blurHandler&&e.context.blurHandler(...t)),onChange:t[1]||(t[1]=(...e)=>h.handleFile&&h.handleFile(...e)),onDragover:t[2]||(t[2]=(...e)=>h.handleDragOver&&h.handleDragOver(...e)),onDragleave:t[3]||(t[3]=(...e)=>h.handleDragLeave&&h.handleDragLeave(...e))}),null,16,dt),_(p,{name:"uploadAreaMask",context:e.context,"has-files":h.hasFiles},{default:y((()=>[V((o(),l(x(e.context.slotComponents.uploadAreaMask),{"has-files":"div"!==e.context.slotComponents.uploadAreaMask&&h.hasFiles,"data-has-files":"div"===e.context.slotComponents.uploadAreaMask&&h.hasFiles,class:m(e.context.classes.uploadAreaMask)},null,8,["has-files","data-has-files","class"])),[[A,!h.hasFiles]])])),_:1},8,["context","has-files"]),h.hasFiles?(o(),l(b,{key:0,files:e.context.model,"image-preview":"image"===e.context.type&&"preview"===e.context.imageBehavior,context:e.context},null,8,["files","image-preview","context"])):c("",!0)],10,ct),_(p,{name:"suffix",context:e.context},{default:y((()=>[e.context.slotComponents.suffix?(o(),l(x(e.context.slotComponents.suffix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"])],10,ut)}]]);const pt=we({props:{context:{type:Object,required:!0},removeItem:{type:Function,required:!0},index:{type:Number,required:!0}}},[["render",function(e,t,r,a,u,h){const p=s("FormulateSlot");return o(),i("div",{class:m(r.context.classes.groupRepeatable)},["after"===r.context.removePosition?d(e.$slots,"default",{key:0}):c("",!0),_(p,{name:"remove",context:r.context,index:r.index,"remove-item":r.removeItem},{default:y((()=>[(o(),l(x(r.context.slotComponents.remove),n({context:r.context,index:r.index,"remove-item":r.removeItem},r.context.slotProps.remove),null,16,["context","index","remove-item"]))])),_:1},8,["context","index","remove-item"]),"before"===r.context.removePosition?d(e.$slots,"default",{key:1}):c("",!0)],2)}]]),mt=["data-is-repeatable","aria-labelledby"];const ft=we({name:"FormulateInputGroup",props:{context:{type:Object,required:!0}},computed:{options(){return this.context.options||[]},subType(){return"group"===this.context.type?"grouping":"inputs"},optionsWithContext(){const e=this.context,{attributes:t}=e,r=t,{id:s}=r,o=__objRest(r,["id"]),i=e,{blurHandler:n,classification:a,component:l,getValidationErrors:u,hasLabel:c,hasValidationErrors:d,isSubField:h,isValid:p,labelPosition:m,options:f,performValidation:x,setErrors:y,slotComponents:b,slotProps:g,validationErrors:v,visibleValidationErrors:E,classes:_,showValidationErrors:V,rootEmit:P,help:w,pseudoProps:F,rules:O,model:A}=i,$=__objRest(i,["attributes","blurHandler","classification","component","getValidationErrors","hasLabel","hasValidationErrors","isSubField","isValid","labelPosition","options","performValidation","setErrors","slotComponents","slotProps","validationErrors","visibleValidationErrors","classes","showValidationErrors","rootEmit","help","pseudoProps","rules","model"]);return this.options.map((e=>this.groupItemContext($,e,o)))},totalItems(){return Array.isArray(this.context.model)&&this.context.model.length>this.context.minimum?this.context.model.length:this.context.minimum||1},canAddMore(){return this.context.repeatable&&this.totalItems<this.context.limit},labelledBy(){return this.context.label&&`${this.context.id}_label`}},methods:{addItem(){if(Array.isArray(this.context.model)){const e=this.context.minimum-this.context.model.length+1,t=Math.max(e,1);for(let r=0;r<t;r++)this.context.model.push(M({}))}else this.context.model=Array.from({length:this.totalItems+1}).fill("").map((()=>M({})));this.context.rootEmit("repeatableAdded",this.context.model)},groupItemContext:(e,t,r)=>Object.assign({},e,t,r,{isGrouped:!0},e.hasGivenName?{}:{name:!0})}},[["render",function(e,t,r,a,u,h){const p=s("FormulateSlot"),f=s("FormulateInput"),b=s("FormulateGrouping");return o(),i("div",{class:m(r.context.classes.element),"data-is-repeatable":r.context.repeatable,role:"group","aria-labelledby":h.labelledBy},[_(p,{name:"prefix",context:r.context},{default:y((()=>[r.context.slotComponents.prefix?(o(),l(x(r.context.slotComponents.prefix),{key:0,context:r.context},null,8,["context"])):c("",!0)])),_:1},8,["context"]),"grouping"!==h.subType?(o(!0),i(v,{key:0},E(h.optionsWithContext,(e=>(o(),l(f,n({key:e.id,modelValue:r.context.model,"onUpdate:modelValue":t[0]||(t[0]=e=>r.context.model=e),ref_for:!0},e,{"disable-errors":!0,"prevent-deregister":!0,class:"formulate-input-group-item",onBlur:r.context.blurHandler}),null,16,["modelValue","onBlur"])))),128)):(o(),i(v,{key:1},[_(b,{context:r.context},{default:y((()=>[d(e.$slots,"default")])),_:3},8,["context"]),h.canAddMore?(o(),l(p,{key:0,name:"addmore",context:r.context,"add-more":h.addItem},{default:y((()=>[(o(),l(x(r.context.slotComponents.addMore),n({context:r.context,"add-more":h.addItem},r.context.slotProps.addMore,{onAdd:h.addItem}),null,16,["context","add-more","onAdd"]))])),_:1},8,["context","add-more"])):c("",!0)],64)),_(p,{name:"suffix",context:r.context},{default:y((()=>[r.context.slotComponents.suffix?(o(),l(x(r.context.slotComponents.suffix),{key:0,context:r.context},null,8,["context"])):c("",!0)])),_:1},8,["context"])],10,mt)}]]),xt=["data-type"],yt=["type"];const bt=we({name:"FormulateInputButton",mixins:[Ye]},[["render",function(e,t,r,a,h,p){const b=s("FormulateSlot");return o(),i("div",{class:m(e.context.classes.element),"data-type":e.context.type},[_(b,{name:"prefix",context:e.context},{default:y((()=>[e.context.slotComponents.prefix?(o(),l(x(e.context.slotComponents.prefix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"]),f("button",n({type:e.type},e.attributes,u(e.$attrs,!0)),[d(e.$slots,"default",{context:e.context},(()=>[(o(),l(x(e.context.slotComponents.buttonContent),{context:e.context},null,8,["context"]))]))],16,yt),_(b,{name:"suffix",context:e.context},{default:y((()=>[e.context.slotComponents.suffix?(o(),l(x(e.context.slotComponents.suffix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"])],10,xt)}]]),gt=["data-type","data-multiple"],vt=["data-placeholder-selected"],Et=["selected"],_t=["value","disabled","textContent"],Vt=["label"],Pt=["value","disabled","textContent"];const wt=we({name:"FormulateInputSelect",mixins:[Ye],computed:{options(){return this.context.options||{}},optionGroups(){return this.context.optionGroups||!1},placeholderSelected(){return!(this.hasValue||!this.context.attributes||!this.context.attributes.placeholder)}}},[["render",function(e,t,r,a,d,h){const p=s("FormulateSlot");return o(),i("div",{class:m(e.context.classes.element),"data-type":e.context.type,"data-multiple":e.attributes&&void 0!==e.attributes.multiple},[_(p,{name:"prefix",context:e.context},{default:y((()=>[e.context.slotComponents.prefix?(o(),l(x(e.context.slotComponents.prefix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"]),V(f("select",n({"onUpdate:modelValue":t[0]||(t[0]=t=>e.context.model=t)},e.attributes,{"data-placeholder-selected":h.placeholderSelected},u(e.$attrs,!0),{onBlur:t[1]||(t[1]=(...t)=>e.context.blurHandler&&e.context.blurHandler(...t))}),[e.context.placeholder?(o(),i("option",{key:0,value:"",hidden:"hidden",disabled:"",selected:!e.hasValue},b(e.context.placeholder),9,Et)):c("",!0),h.optionGroups?(o(!0),i(v,{key:2},E(h.optionGroups,((e,t)=>(o(),i("optgroup",{key:t,label:t},[(o(!0),i(v,null,E(e,(e=>(o(),i("option",n({key:e.id,value:e.value,disabled:!!e.disabled,ref_for:!0},e.attributes||e.attrs||{},{textContent:b(e.label)}),null,16,Pt)))),128))],8,Vt)))),128)):(o(!0),i(v,{key:1},E(h.options,(e=>(o(),i("option",n({key:e.id,value:e.value,disabled:!!e.disabled,ref_for:!0},e.attributes||e.attrs||{},{textContent:b(e.label)}),null,16,_t)))),128))],16,vt),[[$,e.context.model]]),_(p,{name:"suffix",context:e.context},{default:y((()=>[e.context.slotComponents.suffix?(o(),l(x(e.context.slotComponents.suffix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"])],10,gt)}]]),Ft=["data-type"],Ot=["type"],At=["textContent"];const $t=we({name:"FormulateInputSlider",mixins:[Ye]},[["render",function(e,t,r,a,d,h){const p=s("FormulateSlot");return o(),i("div",{class:m(e.context.classes.element),"data-type":e.context.type},[_(p,{name:"prefix",context:e.context},{default:y((()=>[e.context.slotComponents.prefix?(o(),l(x(e.context.slotComponents.prefix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"]),V(f("input",n({"onUpdate:modelValue":t[0]||(t[0]=t=>e.context.model=t),type:e.type},e.attributes,u(e.$attrs,!0),{onBlur:t[1]||(t[1]=(...t)=>e.context.blurHandler&&e.context.blurHandler(...t))}),null,16,Ot),[[F,e.context.model]]),e.context.showValue?(o(),i("div",{key:0,class:m(e.context.classes.rangeValue),textContent:b(e.context.model)},null,10,At)):c("",!0),_(p,{name:"suffix",context:e.context},{default:y((()=>[e.context.slotComponents.suffix?(o(),l(x(e.context.slotComponents.suffix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"])],10,Ft)}]]),jt=["textContent"];const Ct=we({props:{context:{type:Object,required:!0}}},[["render",function(e,t,r,s,n,a){return o(),i("span",{class:m(`formulate-input-element--${r.context.type}--label`),textContent:b(r.context.value||r.context.label||r.context.name||"Submit")},null,10,jt)}]]);const kt=we({name:"FormulateInputTextArea",mixins:[Ye]},[["render",function(e,t,r,a,d,h){const p=s("FormulateSlot");return o(),i("div",{class:m(e.context.classes.element),"data-type":"textarea"},[_(p,{name:"prefix",context:e.context},{default:y((()=>[e.context.slotComponents.prefix?(o(),l(x(e.context.slotComponents.prefix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"]),V(f("textarea",n({"onUpdate:modelValue":t[0]||(t[0]=t=>e.context.model=t)},e.attributes,u(e.$attrs,!0),{onBlur:t[1]||(t[1]=(...t)=>e.context.blurHandler&&e.context.blurHandler(...t))}),null,16),[[j,e.context.model]]),_(p,{name:"suffix",context:e.context},{default:y((()=>[e.context.slotComponents.suffix?(o(),l(x(e.context.slotComponents.suffix),{key:0,context:e.context},null,8,["context"])):c("",!0)])),_:1},8,["context"])],2)}]]);const St=we({provide(){return __spreadProps(__spreadValues({},Ee(this,["getFormValues"])),{formulateSetter:(e,t)=>this.setGroupValue(e,t)})},inject:{registerProvider:"registerProvider",deregisterProvider:"deregisterProvider"},props:{index:{type:Number,required:!0},context:{type:Object,required:!0},uuid:{type:String,required:!0},errors:{type:Object,required:!0}},emits:["remove","validation"],data(){return __spreadProps(__spreadValues({},ye(this)),{isGrouping:!0})},computed:__spreadProps(__spreadValues({},be()),{mergedFieldErrors(){return this.errors}}),watch:__spreadProps(__spreadValues({},ve()),{"context.model":{handler(e){I(e[this.index],this.proxy,!0)||this.setValues(e[this.index])},deep:!0}}),created(){this.applyInitialValues(),this.registerProvider(this)},beforeUnmount(){this.preventCleanup=!0,this.deregisterProvider(this)},methods:__spreadProps(__spreadValues({},ge()),{setGroupValue(e,t){I(this.proxy[e],t,!0)||this.setFieldValue(e,t)},removeItem(){this.$emit("remove",this.index)}})},[["render",function(e,t,r,i,a,u){const c=s("FormulateSlot");return o(),l(c,{name:"repeatable",context:r.context,index:r.index,"remove-item":u.removeItem},{default:y((()=>[(o(),l(x(r.context.slotComponents.repeatable),n({context:r.context,index:r.index,"remove-item":u.removeItem},r.context.slotProps.repeatable),{default:y((()=>[_(c,{context:r.context,index:r.index,name:"default"},null,8,["context","index"])])),_:1},16,["context","index","remove-item"]))])),_:1},8,["context","index","remove-item"])}]]),It=["data-disabled","textContent"];const Nt=we({props:{index:{type:Number,default:null},context:{type:Object,required:!0},removeItem:{type:Function,required:!0}}},[["render",function(e,t,r,s,n,l){return r.context.repeatable?(o(),i("a",{key:0,class:m(r.context.classes.groupRepeatableRemove),"data-disabled":r.context.model.length<=r.context.minimum,role:"button",onClick:t[0]||(t[0]=a(((...e)=>r.removeItem&&r.removeItem(...e)),["prevent"])),onKeypress:t[1]||(t[1]=C(((...e)=>r.removeItem&&r.removeItem(...e)),["enter"])),textContent:b(r.context.removeLabel)},null,42,It)):c("",!0)}]]);e("default",class{constructor(){this.options={},this.defaults={components:{FormulateSlot:he,FormulateForm:Fe,FormulateFile:qe,FormulateHelp:Be,FormulateLabel:Ke,FormulateInput:De,FormulateErrors:Re,FormulateSchema:fe,FormulateAddMore:ze,FormulateGrouping:He,FormulateInputBox:Xe,FormulateInputText:it,FormulateInputFile:ht,FormulateErrorList:rt,FormulateRepeatable:pt,FormulateInputGroup:ft,FormulateInputButton:bt,FormulateInputSelect:wt,FormulateInputSlider:$t,FormulateButtonContent:Ct,FormulateInputTextArea:kt,FormulateRepeatableRemove:Nt,FormulateRepeatableProvider:St},slotComponents:{addMore:"FormulateAddMore",buttonContent:"FormulateButtonContent",errorList:"FormulateErrorList",errors:"FormulateErrors",file:"FormulateFile",help:"FormulateHelp",label:"FormulateLabel",prefix:!1,remove:"FormulateRepeatableRemove",repeatable:"FormulateRepeatable",suffix:!1,uploadAreaMask:"div"},slotProps:{},library:k,rules:J,mimes:Q,locale:!1,uploader:de,uploadUrl:!1,fileUrlKey:"url",uploadJustCompleteDuration:1e3,errorHandler:e=>e,plugins:[ce],locales:{},failedValidation:()=>!1,idPrefix:"formulate-",baseClasses:e=>e,coreClasses:ie,classes:{},useInputDecorators:!0,validationNameStrategy:!1},this.registry=new Map,this.idRegistry={}}install(e,t){this.options=this.defaults;var r=this.defaults.plugins;for(var s in t&&Array.isArray(t.plugins)&&t.plugins.length&&(r=r.concat(t.plugins)),r.forEach((e=>"function"==typeof e?e(this):null)),this.extend(t||{}),this.options.components)e.component(s,this.options.components[s])}nextId(e){const t=!(!e.$route||!e.$route.path)&&e.$route.path?e.$route.path.replace(/[/\\.\s]/g,"-"):"global";return Object.prototype.hasOwnProperty.call(this.idRegistry,t)||(this.idRegistry[t]=0),`${this.options.idPrefix}${t}-${++this.idRegistry[t]}`}extend(e){if("object"==typeof e)return this.options=this.merge(this.options,e),this;throw new Error("Formulate.extend expects an object, was "+typeof e)}merge(e,t,r=!0){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(t,o)?ae(t[o])&&ae(e[o])?s[o]=this.merge(e[o],t[o],r):r&&Array.isArray(e[o])&&Array.isArray(t[o])?s[o]=e[o].concat(t[o]):s[o]=t[o]:s[o]=e[o];for(var i in t)Object.prototype.hasOwnProperty.call(s,i)||(s[i]=t[i]);return s}classify(e){return Object.prototype.hasOwnProperty.call(this.options.library,e)?this.options.library[e].classification:"unknown"}classes(e){const t=this.options.coreClasses(e),r=this.options.baseClasses(t,e);return Object.keys(r).reduce(((t,s)=>{let o=oe(r[s],this.options.classes[s],e);var i,n,a,l;return o=oe(o,e[`${s}Class`],e),i=s,n=o,a=this.options.classes,l=e,o=Object.keys(ee).reduce(((e,t)=>{if(ee[t](l)){const r=`${i}${D(t)}`,s=`${r}Class`;a[r]&&(e=oe(e,"string"==typeof a[r]?R(a[r]):a[r],l)),l[s]&&(e=oe(e,"string"==typeof l[s]?R(l[s]):l[`${r}Class`],l))}return e}),n),Object.assign(t,{[s]:o})}),{})}typeProps(e){const t=e=>Object.keys(e).reduce(((t,r)=>Array.isArray(e[r])?t.concat(e[r]):t),[]),r=t(this.options.slotProps);return this.options.library[e]?r.concat(t(this.options.library[e].slotProps||{})):r}slotProps(e,t,r){let s=Array.isArray(this.options.slotProps[t])?this.options.slotProps[t]:[];const o=this.options.library[e];return o&&o.slotProps&&Array.isArray(o.slotProps[t])&&(s=s.concat(o.slotProps[t])),s.reduce(((e,t)=>Object.assign(e,{[t]:r[t]})),{})}component(e){return!!Object.prototype.hasOwnProperty.call(this.options.library,e)&&this.options.library[e].component}slotComponent(e,t){const r=this.options.library[e];return r&&r.slotComponents&&r.slotComponents[t]?r.slotComponents[t]:this.options.slotComponents[t]}rules(e={}){return __spreadValues(__spreadValues({},this.options.rules),e)}i18n(e){if(e.$i18n)switch(typeof e.$i18n.locale){case"string":return e.$i18n.locale;case"function":return e.$i18n.locale()}return!1}getLocale(e){return this.selectedLocale||(this.selectedLocale=[this.options.locale,this.i18n(e),"en"].reduce(((e,t)=>{if(e)return e;if(t){const r=function(e){return e.split("-").reduce(((e,t)=>(e.length&&e.unshift(`${e[0]}-${t}`),e.length?e:[t])),[])}(t).find((e=>U(this.options.locales,e)));r&&(e=r)}return e}),!1)),this.selectedLocale}setLocale(e){U(this.options.locales,e)&&(this.options.locale=e,this.selectedLocale=e,this.registry.forEach(((e,t)=>{e.hasValidationErrors()})))}validationMessage(e,t,r){const s=this.options.locales[this.getLocale(r)];return Object.prototype.hasOwnProperty.call(s,e)?s[e](t):Object.prototype.hasOwnProperty.call(s,"default")?s.default(t):"Invalid field value"}register(e){"FormulateForm"===e.$options.name&&e.name&&this.registry.set(e.name,e)}deregister(e){"FormulateForm"===e.$options.name&&e.name&&this.registry.has(e.name)&&this.registry.delete(e.name)}handle(e,t,r=!1){const s=r?e:this.options.errorHandler(e,t);return t&&this.registry.has(t)&&this.registry.get(t).applyErrors({formErrors:R(s.formErrors),inputErrors:s.inputErrors||{}}),s}reset(e,t={}){this.resetValidation(e),this.setValues(e,t)}submit(e){this.registry.get(e).formSubmitted()}resetValidation(e){const t=this.registry.get(e);t.hideErrors(e),t.namedErrors=[],t.namedFieldErrors={}}setValues(e,t){if(t&&!Array.isArray(t)&&"object"==typeof t){this.registry.get(e).setValues(__spreadValues({},t))}}getUploader(){return this.options.uploader||!1}getUploadUrl(){return this.options.uploadUrl||!1}getFileUrlKey(){return this.options.fileUrlKey||"url"}createUpload(e,t){return new Y(e,t,this.options)}failedValidation(e){return this.options.failedValidation(this)}})}}}));
//# sourceMappingURL=formulate.system.js.map
